<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!--
 * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
 * Copyright 2025 Xyna GmbH, Germany
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *  http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
-->
<Service xmlns="http://www.gip.com/xyna/xdev/xfractmod" Label="Parse Key Value List Into Map" TypeName="ParseKeyValueListIntoMap" TypePath="xfmg.tmf633" Version="1.8">
  <Meta>
    <Documentation>Expects value in Format &lt;key&gt;=&lt;value&gt;(, &lt;key&gt;=&lt;value&gt;)*</Documentation>
  </Meta>
  <Operation ID="0" IsStatic="false" Label="Parse Key Value List Into Map" Name="ParseKeyValueListIntoMap">
    <Input>
      <Data ID="2" Label="Text" ReferenceName="Text" ReferencePath="base" VariableName="text2"/>
    </Input>
    <Output>
      <Data ID="7" Label="HashMap" ReferenceName="HashMap" ReferencePath="base.list" VariableName="hashMap7"/>
    </Output>
    <ServiceReference ID="813" Label="HashMap" ReferenceName="HashMap.HashMap" ReferencePath="base.list">
      <Source RefID="812"/>
      <Target RefID="812"/>
    </ServiceReference>
    <ServiceReference ID="34" Label="Regular Expression Utils" ReferenceName="RegularExpressionUtils.RegularExpressionUtils" ReferencePath="xint">
      <Source RefID="33"/>
      <Target RefID="33"/>
    </ServiceReference>
    <ServiceReference ID="326" Label="Regular Expression Utils" ReferenceName="RegularExpressionUtils.RegularExpressionUtils" ReferencePath="xint">
      <Source RefID="325"/>
      <Target RefID="325"/>
    </ServiceReference>
    <Mappings ID="53" Label="Mapping">
      <Output>
        <Data ID="70" Label="HashMap" ReferenceName="HashMap" ReferencePath="base.list" VariableName="hashMap70">
          <Source RefID="53"/>
        </Data>
        <Target RefID="71"/>
      </Output>
      <Output>
        <Data ID="88" Label="Regexp split komma" ReferenceName="RegularExpression" ReferencePath="xint" VariableName="regularExpression88">
          <Source RefID="53"/>
        </Data>
        <Target RefID="89"/>
      </Output>
      <Output>
        <Data ID="377" Label="Regexp split =" ReferenceName="RegularExpression" ReferencePath="xint" VariableName="regularExpression377">
          <Source RefID="53"/>
        </Data>
        <Target RefID="378"/>
      </Output>
      <Mapping>%1%.expression=" *, *"</Mapping>
      <Mapping>%2%.expression=" *= *"</Mapping>
    </Mappings>
    <Function ID="33" Label="Split">
      <Source RefID="34"/>
      <Source RefID="89"/>
      <Source RefID="2"/>
      <Target RefID="34"/>
      <Target RefID="36"/>
      <Invoke Operation="split" ServiceID="34">
        <Source RefID="89">
          <Meta>
            <LinkType>UserConnected</LinkType>
          </Meta>
        </Source>
        <Source RefID="2"/>
      </Invoke>
      <Receive ServiceID="34">
        <Target RefID="36"/>
      </Receive>
    </Function>
    <Foreach ID="306">
      <Source RefID="36"/>
      <InputList RefID="36">
        <Data ID="307" Label="Parts" ReferenceName="Text" ReferencePath="base" VariableName="text307"/>
      </InputList>
      <Choice ID="218" TypeName="BaseChoiceTypeFormula" TypePath="server">
        <Source RefID="307"/>
        <Input>
          <Data ID="241" Label="Parts" ReferenceName="Text" ReferencePath="base" VariableName="text241">
            <Source RefID="218"/>
          </Data>
          <Source RefID="307">
            <Meta>
              <LinkType>UserConnected</LinkType>
            </Meta>
          </Source>
        </Input>
        <Case ID="219" Label="true" Premise="%0%!=null">
          <Function ID="325" Label="Split">
            <Source RefID="326"/>
            <Source RefID="378"/>
            <Source RefID="307"/>
            <Target RefID="326"/>
            <Target RefID="328"/>
            <Invoke Operation="split" ServiceID="326">
              <Source RefID="378">
                <Meta>
                  <LinkType>UserConnected</LinkType>
                </Meta>
              </Source>
              <Source RefID="307">
                <Meta>
                  <LinkType>UserConnected</LinkType>
                </Meta>
              </Source>
            </Invoke>
            <Receive ServiceID="326">
              <Target RefID="328"/>
            </Receive>
          </Function>
          <Mappings ID="678" Label="Mapping">
            <Input>
              <Data ID="779" IsList="true" Label="Text" ReferenceName="Text" ReferencePath="base" VariableName="text779">
                <Source RefID="678"/>
              </Data>
              <Source RefID="328">
                <Meta>
                  <LinkType>UserConnected</LinkType>
                </Meta>
              </Source>
            </Input>
            <Output>
              <Data ID="711" Label="Key" ReferenceName="Text" ReferencePath="base" VariableName="text711">
                <Source RefID="678"/>
              </Data>
              <Target RefID="712"/>
            </Output>
            <Output>
              <Data ID="745" Label="Value" ReferenceName="Text" ReferencePath="base" VariableName="text745">
                <Source RefID="678"/>
              </Data>
              <Target RefID="746"/>
            </Output>
            <Mapping>%1%=%0%["0"]</Mapping>
            <Mapping>%2%=%0%["1"]</Mapping>
          </Mappings>
          <Function ID="812" Label="put">
            <Source RefID="813"/>
            <Source RefID="71"/>
            <Source RefID="712"/>
            <Source RefID="746"/>
            <Target RefID="813"/>
            <Invoke Operation="put" ServiceID="813">
              <Source RefID="71"/>
              <Source RefID="712">
                <Meta>
                  <LinkType>UserConnected</LinkType>
                </Meta>
              </Source>
              <Source RefID="746">
                <Meta>
                  <LinkType>UserConnected</LinkType>
                </Meta>
              </Source>
            </Invoke>
            <Receive ServiceID="813"/>
          </Function>
          <Assign ID="222"/>
          <Data ID="328" IsList="true" Label="Parts" ReferenceName="Text" ReferencePath="base" VariableName="text328">
            <Source RefID="325"/>
          </Data>
        </Case>
        <Case ID="220" Label="false">
          <Assign ID="224"/>
        </Case>
      </Choice>
      <Data ID="712" Label="Key" ReferenceName="Text" ReferencePath="base" VariableName="text712">
        <Source RefID="678"/>
      </Data>
      <Data ID="746" Label="Value" ReferenceName="Text" ReferencePath="base" VariableName="text746">
        <Source RefID="678"/>
      </Data>
    </Foreach>
    <Data ID="36" IsList="true" Label="Parts" ReferenceName="Text" ReferencePath="base" VariableName="text36">
      <Source RefID="33"/>
    </Data>
    <Data ID="71" Label="HashMap" ReferenceName="HashMap" ReferencePath="base.list" VariableName="hashMap71">
      <Source RefID="53"/>
    </Data>
    <Data ID="89" Label="Regular Expression" ReferenceName="RegularExpression" ReferencePath="xint" VariableName="regularExpression89">
      <Source RefID="53"/>
    </Data>
    <Data ID="378" Label="Regular Expression" ReferenceName="RegularExpression" ReferencePath="xint" VariableName="regularExpression378">
      <Source RefID="53"/>
    </Data>
    <Assign ID="1">
      <Source RefID="71"/>
      <Target RefID="7"/>
      <Copy>
        <Source RefID="71"/>
        <Target RefID="7"/>
      </Copy>
    </Assign>
  </Operation>
</Service>
