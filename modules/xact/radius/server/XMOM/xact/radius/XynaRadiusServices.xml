<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!--
 * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
 * Copyright 2026 Xyna GmbH, Germany
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *  http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
--><DataType xmlns="http://www.gip.com/xyna/xdev/xfractmod" IsAbstract="false" Label="XynaRadiusServices" TypeName="XynaRadiusServices" TypePath="xact.radius" Version="1.8">
  <Meta>
    <IsServiceGroupOnly>true</IsServiceGroupOnly>
  </Meta>
  <Libraries>XynaRadiusServicesImpl.jar</Libraries>
  <Service Label="XynaRadiusServices" TypeName="XynaRadiusServices">
    <Operation IsStatic="true" Label="Validate Credentials" Name="validateCredentials">
      <Input>
        <Data ID="1" Label="Radius User" ReferenceName="RadiusUser" ReferencePath="xact.radius" VariableName="radiusUser1"/>
        <Data ID="2" Label="RequestAuthenticator" ReferenceName="RequestAuthenticator" ReferencePath="xact.radius" VariableName="requestAuthenticator2"/>
      </Input>
      <Output>
        <Data ID="3" Label="Code" ReferenceName="Code" ReferencePath="xact.radius" VariableName="code3"/>
      </Output>
      <Meta>
        <Documentation>Validate the user credentials (CHAP).
Returns the Code "2" if the the validation was successful, else "3".</Documentation>
      </Meta>
      <SourceCode>
        <CodeSnippet Type="Java">return xact.radius.XynaRadiusServicesImpl.validateCredentials(radiusUser1, requestAuthenticator2);</CodeSnippet>
      </SourceCode>
    </Operation>
    <Operation IsStatic="true" Label="Check Credentials Expired" Name="checkCredentialsExpired">
      <Input>
        <Data ID="4" Label="Radius User" ReferenceName="RadiusUser" ReferencePath="xact.radius" VariableName="radiusUser4"/>
      </Input>
      <Output>
        <Data ID="5" Label="Text" ReferenceName="Text" ReferencePath="base" VariableName="text5"/>
      </Output>
      <Meta>
        <Documentation>Reads the property "xact.radius.passwordExpirationTime" and the Timestamp when the user was created to check whether the user credentials have expired.
Returns the Text "true", if the password has expired, else "false".
Always returns "false" for permanent users.</Documentation>
      </Meta>
      <SourceCode>
        <CodeSnippet Type="Java">return xact.radius.XynaRadiusServicesImpl.checkCredentialsExpired(radiusUser4);</CodeSnippet>
      </SourceCode>
    </Operation>
    <Operation IsStatic="true" Label="Get Privilege Level" Name="getPrivilegeLevel">
      <Input>
        <Data ID="6" Label="Functional Role" ReferenceName="FunctionalRole" ReferencePath="xact.radius" VariableName="functionalRole6"/>
        <Data ID="7" Label="Vendor" ReferenceName="Vendor" ReferencePath="xact.radius" VariableName="vendor7"/>
      </Input>
      <Output>
        <Data ID="8" Label="Privilege Level" ReferenceName="PrivilegeLevel" ReferencePath="xact.radius" VariableName="privilegeLevel8"/>
      </Output>
      <SourceCode>
        <CodeSnippet Type="Java">return xact.radius.XynaRadiusServicesImpl.getPrivilegeLevel(functionalRole6, vendor7);</CodeSnippet>
      </SourceCode>
    </Operation>
    <Operation IsStatic="true" Label="Get Xyna Property" Name="getXynaProperty">
      <Input>
        <Data ID="9" Label="Xyna property key" ReferenceName="XynaPropertyKey" ReferencePath="xact.radius" VariableName="xynaPropertyKey9"/>
      </Input>
      <Output>
        <Data ID="10" Label="Xyna property string value" ReferenceName="XynaPropertyStringValue" ReferencePath="xact.radius" VariableName="xynaPropertyStringValue10"/>
      </Output>
      <SourceCode>
        <CodeSnippet Type="Java">return xact.radius.XynaRadiusServicesImpl.getXynaProperty(xynaPropertyKey9);</CodeSnippet>
      </SourceCode>
    </Operation>
    <Operation IsStatic="true" Label="Get Basic User Info from Nodes" Name="getBasicUserInfoFromNodes">
      <Input>
        <Data ID="11" IsList="true" Label="Node" ReferenceName="Node" ReferencePath="xact.radius" VariableName="node11"/>
      </Input>
      <Output>
        <Data ID="12" Label="Radius User" ReferenceName="RadiusUser" ReferencePath="xact.radius" VariableName="radiusUser12"/>
      </Output>
      <Meta>
        <Documentation>Get username, password and nas-identifier from the nodes sent in the access request.</Documentation>
      </Meta>
      <SourceCode>
        <CodeSnippet Type="Java">return xact.radius.XynaRadiusServicesImpl.getBasicUserInfoFromNodes(node11);</CodeSnippet>
      </SourceCode>
    </Operation>
  </Service>
</DataType>
